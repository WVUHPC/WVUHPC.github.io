

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Bioinformatics: Conda and BioConda &mdash; WVU-RC 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bioinformatics: Using Bowtie2" href="75.bowtie2.html" />
    <link rel="prev" title="Engineering: Running OpenFOAM simple tutorial" href="73.OpenFoam.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> WVU-RC
          

          
            
            <img src="../_static/ResearchComputing.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10.Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="20.QuickStart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="30.BasicUser.html">For Basic Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="40.AdvancedUser.html">For Advanced Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="50.Developers.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="60.Administrators.html">For Administrators</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="70.DomainSpecific.html">Domain Specific Details</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="71.Ansys.html">Engineering: ANSYS Products</a></li>
<li class="toctree-l2"><a class="reference internal" href="72.ANSYSForte.html">Engineering: ANSYS/Forte</a></li>
<li class="toctree-l2"><a class="reference internal" href="73.OpenFoam.html">Engineering: Running OpenFOAM simple tutorial</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Bioinformatics: Conda and BioConda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preparing-the-environment">Preparing the environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#knowing-which-environments-are-available">Knowing which environments are available</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activating-an-existing-environment">Activating an existing environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deactivating-the-current-environment">Deactivating the current environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-new-environment-from-a-yml-file">Creating a new environment from a YML file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listing-the-packages-inside-one-environment">Listing the packages inside one environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-a-conda-environment-in-a-submission-script">Using a conda environment in a submission script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deleting-a-environment">Deleting a environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-documentation">More documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="75.bowtie2.html">Bioinformatics: Using Bowtie2</a></li>
<li class="toctree-l2"><a class="reference internal" href="76.Matlab.html">Matlab: Running Matlab scripts on a HPC cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="77.Visit.html">Visualization: VisIt</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="80.ClusterSpecific.html">Clusters Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="90.References.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WVU-RC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="70.DomainSpecific.html">Domain Specific Details</a> &raquo;</li>
        
      <li>Bioinformatics: Conda and BioConda</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/text/74.Bioconda.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bioinformatics-conda-and-bioconda">
<h1>Bioinformatics: Conda and BioConda<a class="headerlink" href="#bioinformatics-conda-and-bioconda" title="Permalink to this headline">¶</a></h1>
<p><strong>Conda</strong> is an open source package management system and environment
management system that runs on Windows, macOS and Linux. Conda quickly
installs, runs and updates packages and their dependencies. Conda easily
creates, saves, loads and switches between environments.</p>
<p>We have Conda installed on Spruce, all that you have to do to enable the
conda environment is to execute:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">conda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p><strong>Bioconda</strong> is a channel for the conda package manager specializing in
bioinformatics software. Bioconda offers a repository of more than 4000
bioinformatics packages</p>
<p>In the future most packages in bioinformatics will be offered via
Bioconda instead of independent modules. That allow us to keep packages
consistent and updated.</p>
<p>To get a better idea about using bioconda and the packages provided here
we prepare a basic tutorial on its usage on Spruce.</p>
<div class="section" id="preparing-the-environment">
<h2>Preparing the environment<a class="headerlink" href="#preparing-the-environment" title="Permalink to this headline">¶</a></h2>
<p>On spruce:</p>
<p>You can load the module, but it only remembers you the script that needs
to be sourced to operate with Bioconda</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">genomics</span><span class="o">/</span><span class="n">bioconda</span>
</pre></div>
</div>
<p>In fact the conda environment is enable only when you actually source
the script</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">conda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="knowing-which-environments-are-available">
<h2>Knowing which environments are available<a class="headerlink" href="#knowing-which-environments-are-available" title="Permalink to this headline">¶</a></h2>
<p>By the time of writting this tutorial Spruce offers three environments
centrally installed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ conda info --envs
# conda environments:
#
                         /scratch/gufranco/bowtie2
base                  *  /shared/software/miniconda3
qiime2-2018.8            /shared/software/miniconda3/envs/qiime2-2018.8
tpd0001                  /shared/software/miniconda3/envs/tpd0001
</pre></div>
</div>
</div>
<div class="section" id="activating-an-existing-environment">
<h2>Activating an existing environment<a class="headerlink" href="#activating-an-existing-environment" title="Permalink to this headline">¶</a></h2>
<p>Suppose that you want to use the environment called “tpd0001”, to
achieve that execute</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">tpd0001</span>
</pre></div>
</div>
</div>
<div class="section" id="deactivating-the-current-environment">
<h2>Deactivating the current environment<a class="headerlink" href="#deactivating-the-current-environment" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">deactivate</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-new-environment-from-a-yml-file">
<h2>Creating a new environment from a YML file<a class="headerlink" href="#creating-a-new-environment-from-a-yml-file" title="Permalink to this headline">¶</a></h2>
<p>You can create your own environment, one easy way of doing that is via a
YML file that describes the channels and packages that you want on your
environment. The YML file will look like this, for a simple case when
you want one env for bowtie2 (bowtie2.yml)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">spruce</span><span class="o">-</span><span class="n">bowtie2</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bioconda</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
  <span class="o">-</span> <span class="n">defaults</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bowtie2</span>
</pre></div>
</div>
<p>Another example is this YML file for installing a curated set of basic
genomics codes that requires just a few dependencies. (biocore.yml)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">biocode</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bioconda</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
  <span class="o">-</span> <span class="n">defaults</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bamtools</span>
  <span class="o">-</span> <span class="n">bcftools</span>
  <span class="o">-</span> <span class="n">bedtools</span>
  <span class="o">-</span> <span class="n">hmmer</span>
  <span class="o">-</span> <span class="n">muscle</span>
  <span class="o">-</span> <span class="n">raxml</span>
  <span class="o">-</span> <span class="n">samtools</span>
  <span class="o">-</span> <span class="n">sga</span>
  <span class="o">-</span> <span class="n">soapdenovo</span><span class="o">-</span><span class="n">trans</span>
  <span class="o">-</span> <span class="n">soapdenovo2</span>
  <span class="o">-</span> <span class="n">sra</span><span class="o">-</span><span class="n">tools</span>
  <span class="o">-</span> <span class="n">vcftools</span>
  <span class="o">-</span> <span class="n">velvet</span>
</pre></div>
</div>
<p>To create an environment from those YML files you can select one
location on your scratch folder</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>conda env create -p $SCRATCH/bowtie2 -f bowtie2.yml
</pre></div>
</div>
<p>or for the biocore.yml</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>conda env create -p $SCRATCH/biocore -f biocore.yml
</pre></div>
</div>
<p>By default, new environments are created inside your $HOME folder on
$HOME/.conda</p>
</div>
<div class="section" id="listing-the-packages-inside-one-environment">
<h2>Listing the packages inside one environment<a class="headerlink" href="#listing-the-packages-inside-one-environment" title="Permalink to this headline">¶</a></h2>
<p>Bowtie2 has a number of dependencies (19 dependencies for 1 package)
Notice that only bowtie2 comes from bioconda channel. All other packages
are part of conda-forge, a lower level channel.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ conda activate $SCRATCH/bowtie2
$ conda list
# packages in environment at /scratch/gufranco/bowtie2:
#
# Name                    Version                   Build  Channel
bowtie2                   2.3.4.2          py36h2d50403_0    bioconda
bzip2                     1.0.6                h470a237_2    conda-forge
ca-certificates           2018.8.24            ha4d7672_0    conda-forge
certifi                   2018.8.24                py36_1    conda-forge
libffi                    3.2.1                hfc679d8_5    conda-forge
libgcc-ng                 7.2.0                hdf63c60_3    conda-forge
libstdcxx-ng              7.2.0                hdf63c60_3    conda-forge
ncurses                   6.1                  hfc679d8_1    conda-forge
openssl                   1.0.2p               h470a237_0    conda-forge
perl                      5.26.2               h470a237_0    conda-forge
pip                       18.0                     py36_1    conda-forge
python                    3.6.6                h5001a0f_0    conda-forge
readline                  7.0                  haf1bffa_1    conda-forge
setuptools                40.2.0                   py36_0    conda-forge
sqlite                    3.24.0               h2f33b56_1    conda-forge
tk                        8.6.8                         0    conda-forge
wheel                     0.31.1                   py36_1    conda-forge
xz                        5.2.4                h470a237_1    conda-forge
zlib                      1.2.11               h470a237_3    conda-forge
</pre></div>
</div>
</div>
<div class="section" id="using-a-conda-environment-in-a-submission-script">
<h2>Using a conda environment in a submission script<a class="headerlink" href="#using-a-conda-environment-in-a-submission-script" title="Permalink to this headline">¶</a></h2>
<p>To execute software in a non-interactive job you need to source the main
script, activate the environment that contains the software you need,
execute the the scientific code and deactivate the environment. This is
a simple example showing that for bowtie2</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#!/bin/bash

#PBS -N MY_JOB
#PBS -q standby
#PBS -j oe
#PBS -l nodes=1:ppn=2

source /shared/software/miniconda3/etc/profile.d/conda.sh
conda activate $SCRATCH/bowtie2

bowtie2 .....

conda deactivate
</pre></div>
</div>
</div>
<div class="section" id="deleting-a-environment">
<h2>Deleting a environment<a class="headerlink" href="#deleting-a-environment" title="Permalink to this headline">¶</a></h2>
<p>To remove an environment you can just execute this command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>conda remove --all -p $SCRATCH/bowtie2
</pre></div>
</div>
</div>
<div class="section" id="more-documentation">
<h2>More documentation<a class="headerlink" href="#more-documentation" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://conda.io/docs/index.html">Conda Documentation</a></p>
<p>[<a class="reference external" href="https://conda.io/docs/user-guide/tasks/manage-environments.html">https://conda.io/docs/user-guide/tasks/manage-environments.html</a>#
Managing environments]</p>
<p><a class="reference external" href="https://bioconda.github.io/">Using Bioconda — Bioconda
documentation</a></p>
<p><a class="reference external" href="https://bioconda.github.io/recipes.html">Available packages — Bioconda
documentation</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="75.bowtie2.html" class="btn btn-neutral float-right" title="Bioinformatics: Using Bowtie2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="73.OpenFoam.html" class="btn btn-neutral" title="Engineering: Running OpenFOAM simple tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Guillermo Avendano-Franco

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>